# MyAniBook API

REST API для социальной платформы, связанной с аниме. Позволяет регистрировать пользователей, управлять профилями, аниме-листами и постами.

## Стек технологий

- **NestJS** — фреймворк
- **PostgreSQL** — база данных
- **Sequelize** — ORM
- **JWT** — аутентификация
- **Swagger** — документация API
- **Docker** — контейнеризация

## Установка и запуск

### Локально

```bash
# Установить зависимости
npm install

# Запустить в режиме разработки
npm run start:dev

# Собрать и запустить продакшн
npm run build
npm run start:prod
```

### Через Docker

```bash
docker-compose up --build
```

## Переменные окружения

Создай файл `.env` в корне проекта (пример в `.env.example`):

```env
PORT=5000

DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=myanibook

PRIVATE_KEY=your_secret_key
```

## Документация API

После запуска Swagger доступен по адресу:

```
http://localhost:5000/api/docs
```

## Эндпоинты

> Колонка **Доступ** указывает требуемую роль. **USER** — базовая роль, назначается при регистрации автоматически. **ADMIN** — расширенный доступ.

### Авторизация `/auth`

| Метод | Путь | Описание |
|-------|------|----------|
| POST | `/auth/registration` | Регистрация нового пользователя |
| POST | `/auth/login` | Вход, возвращает JWT-токен |

### Пользователи `/users`

| Метод | Путь | Доступ | Описание |
|-------|------|--------|----------|
| POST | `/users` | — | Создать пользователя |
| GET | `/users` | USER | Получить всех пользователей |
| POST | `/users/role` | USER | Назначить роль пользователю |
| POST | `/users/ban` | ADMIN | Забанить пользователя |

### Профиль `/users-info`

| Метод | Путь | Доступ | Описание |
|-------|------|--------|----------|
| GET | `/users-info/:id` | — | Получить профиль по ID пользователя |
| GET | `/users-info` | ADMIN | Получить все профили |
| POST | `/users-info/nickname` | — | Сменить никнейм |
| POST | `/users-info/avatar` | — | Сменить аватар |
| POST | `/users-info/anime-list` | — | Обновить аниме-лист |
| POST | `/users-info/anime-day-of-addition-list` | — | Обновить список дат добавления аниме |

### Роли `/roles`

| Метод | Путь | Описание |
|-------|------|----------|
| POST | `/roles` | Создать роль |
| GET | `/roles/:value` | Получить роль по значению |

### Посты `/posts`

| Метод | Путь | Описание |
|-------|------|----------|
| POST | `/posts` | Создать пост (с изображением) |

